<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Derrick Lee's Blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="/js/jquery.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/theme.css" rel="stylesheet">
</head>

<body>

<div class="container-fluid">
    <div class="row-fluid">
        <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                  <span class="sr-only">Toggle navigation</span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">Derrick Lee's Blog</a>
              </div>
              <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li class="active"><a href="/">Home</a></li>
                    <li class="active visible-xs-block"><a href="/links.html">Links</a></li>
					<li class="active"><a href="/archive.html">Archive</a></li>
					<li class="active"><a href="/categories.html">Categories</a></li>
                    <li class="active"><a href="/tags.html">Tags</a></li>
                    <li class="active"><a href="/about.html">About</a></li>
                    
                      <li class="active"><a href="https://github.com/leesir/leesir.github.io">Github</a></li>
                    
                </ul>
              </div>
        </div>
    </div>
</div>


<div class="container container-left">
    <div class="row">
        <div class="col-md-3 hidden-xs">
            <div class="sidebar well">
译文分享
</div>

<div class="sidebar well">
    <h1>Recent Posts</h1>
    <ul>
        
          <li><a href="/2019/06/cache-pattern-practise">缓存更新策略实践</a></li>
        
          <li><a href="/2019/06/java-javasuger-cc">Java语法糖-条件编译</a></li>
        
          <li><a href="/2019/06/java-assert">Java语法糖-assert</a></li>
        
          <li><a href="/2019/06/system-logincache">一种基于redis的登录态的设计与实现</a></li>
        
          <li><a href="/2019/06/java-javasuger-innerclass">Java语法糖-内部类</a></li>
        
          <li><a href="/2019/06/java-javasuger">Java语法糖</a></li>
        
          <li><a href="/2016/08/java-history">Java的历史</a></li>
        
          <li><a href="/2016/07/java-history-beginning-words">Java历史开篇语</a></li>
        
          <li><a href="/2016/07/project-summary-2">项目总结-2016年07月11日</a></li>
        
          <li><a href="/2016/07/project-summary-1">Project Summary 1</a></li>
        
    </ul>
</div>

<div class="sidebar well">
<h1>Links</h1>
<ul>
  <li><a href="http://ifeve.com/" target="_blank">并发编程网</a></li>
  <li><a href="http://www.infoq.com/cn" target="_blank">InfoQ</a></li>
</ul>

</div>

        </div>
        <div class="col-md-9">
            <div class="article">
                <div class="well">
                    <h1><a href="/2015/10/java-fp-java8-lambda">一个Java 8中简单Lambda表达式程序</a></h1>
                    <br>
                    
                    <div class="post-content">
                        <link rel="stylesheet" href="/css/pygments.css" />

<p><a href="http://www.javacodegeeks.com/2013/05/a-simple-application-of-lambda-expressions-in-java-8.html">原文链接</a> 作者: <a href="http://www.javacodegeeks.com/author/Mohamed-Sanaulla/">Mohamed Sanaulla</a></p>

<p>　　我尝试过把Lambda表达式融入到我的代码中，下面的代码例子是此次尝试的结果。对于那些完全不知道Lambda表达式的Java程序员，我强烈建议在继续阅读之前，浏览一下<a href="http://blog.sanaulla.info/2013/03/11/using-lambda-expression-to-sort-a-list-in-java-8-using-netbeans-lambda-support/">这篇文章</a>。</p>

<p>　　Ok，现在你已经熟悉Lambda表达式了（在阅读过推荐的Lambda入门文章之后），那我们现在开始学习一个我认为很好的Lambda表达式的例子。</p>

<p>　　考虑一下这种场景：某些操作在执行之前需要做预处理，执行之后需要做后期处理。待执行的操作会随着行为的不同而变化。预处理会提取出这个操作所需的必要参数，后期处理做一些清理的工作。</p>

<p>　　我们来看看如何利用接口与接口的匿名实现类模拟这个场景。</p>

<!-- more -->

<p>#使用匿名内部类</p>

<p>　　一个提供了必要行为方法的接口实现：</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">interface</span> <span class="nc">OldPerformer</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">performTask</span><span class="o">(</span><span class="nc">String</span> <span class="n">id</span><span class="o">,</span> <span class="kt">int</span> <span class="n">status</span><span class="o">);</span>

<span class="o">}</span></code></pre></figure>

<p>　　接下来是一些预处理和后期处理方法：</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">PrePostDemo</span> <span class="o">{</span>

    <span class="kd">static</span> <span class="kt">void</span> <span class="nf">performTask</span><span class="o">(</span><span class="nc">String</span> <span class="n">id</span><span class="o">,</span> <span class="nc">OldPerformer</span> <span class="n">performer</span><span class="o">)</span> <span class="o">{</span>

        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Pre-Processing..."</span><span class="o">);</span>

        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Fetching the status for id: "</span> <span class="o">+</span> <span class="n">id</span><span class="o">);</span>

        <span class="kt">int</span> <span class="n">status</span> <span class="o">=</span> <span class="mi">3</span><span class="o">;</span>

        <span class="c1">//Some status value fetched</span>

        <span class="n">performer</span><span class="o">.</span><span class="na">performTask</span><span class="o">(</span><span class="n">id</span><span class="o">,</span> <span class="n">status</span><span class="o">);</span>

        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Post-processing..."</span><span class="o">);</span>

    <span class="o">}</span>

<span class="o">}</span></code></pre></figure>

<p>　　我们需要传递2样东西：预处理所需的标识，以及操作的实现。如下所示：</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">PrePostDemo</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>

    <span class="c1">//has to be declared final to be accessed within</span>

    <span class="c1">//the anonymous inner class.</span>

    <span class="kd">final</span> <span class="nc">String</span> <span class="n">outsideOfImpl</span> <span class="o">=</span> <span class="s">"Common Value"</span><span class="o">;</span>

    <span class="n">performTask</span><span class="o">(</span><span class="s">"1234"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">OldPerformer</span><span class="o">()</span> <span class="o">{</span>

        <span class="nd">@Override</span>

        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">performTask</span><span class="o">(</span><span class="nc">String</span> <span class="n">id</span><span class="o">,</span> <span class="kt">int</span> <span class="n">status</span><span class="o">)</span> <span class="o">{</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Finding data based on id..."</span>

        <span class="o">);</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">outsideOfImpl</span><span class="o">);</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Asserting that the status matches"</span><span class="o">);</span>

        <span class="o">}</span>

    <span class="o">});</span>
	
	    <span class="n">performTask</span><span class="o">(</span><span class="s">"4567"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">OldPerformer</span><span class="o">()</span> <span class="o">{</span>

        <span class="nd">@Override</span>

        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">performTask</span><span class="o">(</span><span class="nc">String</span> <span class="n">id</span><span class="o">,</span> <span class="kt">int</span> <span class="n">status</span><span class="o">)</span> <span class="o">{</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Finding data based on id..."</span><span class="o">);</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">outsideOfImpl</span><span class="o">);</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Update status of the data found"</span><span class="o">);</span>

        <span class="o">}</span>

    <span class="o">});</span>

    <span class="o">}</span>

<span class="o">}</span></code></pre></figure>

<p>　　从上面的代码可以看出，匿名内部类外部的变量要想被匿名内部类访问，需要声明成final。例子的代码输出如下：</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Pre</span><span class="o">-</span><span class="nc">Processing</span><span class="o">...&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
<span class="nc">Fetching</span> <span class="n">the</span> <span class="n">status</span> <span class="k">for</span> <span class="nl">id:</span> <span class="mi">1234</span>

<span class="nc">Finding</span> <span class="n">data</span> <span class="n">based</span> <span class="n">on</span> <span class="n">id</span><span class="o">...</span>

<span class="nc">Common</span> <span class="nc">Value</span>

<span class="nc">Asserting</span> <span class="n">that</span> <span class="n">the</span> <span class="n">status</span> <span class="n">matches</span>

<span class="nc">Post</span><span class="o">-</span><span class="n">processing</span><span class="o">...</span>

<span class="nc">PreProcessing</span><span class="o">...</span>

<span class="nc">Fetching</span> <span class="n">the</span> <span class="n">status</span> <span class="k">for</span> <span class="nl">id:</span> <span class="mi">4567</span>

<span class="nc">Finding</span> <span class="n">data</span> <span class="n">based</span> <span class="n">on</span> <span class="n">id</span><span class="o">...</span>

<span class="nc">Common</span> <span class="nc">Value</span>

<span class="nc">Update</span> <span class="n">the</span> <span class="n">status</span> <span class="n">of</span> <span class="n">the</span> <span class="n">data</span> <span class="n">found</span>

<span class="nc">Post</span><span class="o">-</span><span class="n">processing</span><span class="o">...</span></code></pre></figure>

<p>#使用Lambda表达式</p>

<p>　　我们来看看如何用Lambda表达式实现上述例子：</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">PrePostLambdaDemo</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>

        <span class="c1">//Need not be declared as final for use within a</span>

        <span class="c1">//lambda expression, but has to be eventually final.</span>

        <span class="nc">String</span> <span class="n">outsideOfImpl</span> <span class="o">=</span> <span class="s">"Common Value"</span><span class="o">;</span>

        <span class="n">doSomeProcessing</span><span class="o">(</span><span class="s">"123"</span><span class="o">,</span> <span class="o">(</span><span class="nc">String</span> <span class="n">id</span><span class="o">,</span> <span class="kt">int</span> <span class="n">status</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Finding some data based on"</span><span class="o">+</span><span class="n">id</span><span class="o">);</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">outsideOfImpl</span><span class="o">);</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Assert that the status is "</span><span class="o">+</span><span class="n">status</span> <span class="o">);</span>

        <span class="o">});</span>
		
		<span class="n">doSomeProcessing</span><span class="o">(</span><span class="s">"456"</span><span class="o">,</span> <span class="o">(</span><span class="nc">String</span> <span class="n">id</span><span class="o">,</span> <span class="kt">int</span> <span class="n">status</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">"Finding data based on id: "</span><span class="o">+</span><span class="n">id</span><span class="o">);</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">outsideOfImpl</span><span class="o">);</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"And updating the status: "</span><span class="o">+</span><span class="n">status</span><span class="o">);</span>

        <span class="o">});</span>

    <span class="o">}</span>
	
	<span class="kd">static</span> <span class="kt">void</span> <span class="nf">doSomeProcessing</span><span class="o">(</span><span class="nc">String</span> <span class="n">id</span><span class="o">,</span> <span class="nc">Performer</span> <span class="n">performer</span> <span class="o">){</span>

        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Pre-Processing..."</span><span class="o">);</span>

        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Finding status for given id: "</span><span class="o">+</span><span class="n">id</span><span class="o">);</span>

        <span class="kt">int</span> <span class="n">status</span> <span class="o">=</span> <span class="mi">2</span><span class="o">;</span>

        <span class="n">performer</span><span class="o">.</span><span class="na">performTask</span><span class="o">(</span><span class="n">id</span><span class="o">,</span> <span class="n">status</span><span class="o">);</span>

        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Post-processing..."</span><span class="o">);</span>

    <span class="o">}</span>

<span class="o">}</span>

<span class="kd">interface</span> <span class="nc">Performer</span><span class="o">{</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">performTask</span><span class="o">(</span><span class="nc">String</span> <span class="n">id</span><span class="o">,</span> <span class="kt">int</span> <span class="n">status</span><span class="o">);</span>

<span class="o">}</span></code></pre></figure>

<p>　　除了有趣的Lambda表达式语法之外，还有一点不同，那就是Lambda表达式外部的变量没有声明成final。但最终变量还是会成为常量，这意味着outsideOfImpl 在声明及初始化之后的值不能被更改。</p>

<p>　　这个例子只是展示了如何使用清晰明了的Lambda表达式代替匿名内部类。</p>

<p>　　一个小提示：JDK8的发布时间推迟到了2014年2月，完整的发布时间表可以从<a href="http://openjdk.java.net/projects/jdk8/">这里</a>查阅。我每天都会更新Lambda的构建项目，如果在最新的构建中出现了任何问题，请随时联系我。我会尽最大努力持续构建，并且会在这里发表最新的例子。</p>

<p>　　另一个提示：不要让Java 8的更新使你不知所措，大部分新特性已经存在于其他编程语言中。我发现学习Lambda表达式的语法和方法可以帮助我以函数式的思维进行思考，对此我还应特别感谢Scala闭包。</p>

<p>　　</p>

                    </div>
                    
                </div>
            </div>
            <div class="pagination">
                
                <a class="btn btn-default" href="/2015/10/java-qa-generics-extends-super" class="next">Newer Post</a>
                
                
                <a class="btn btn-default" href="/2015/10/java-fp-java8-lambda-template" class="previous">Older
                    Post</a>
                
            </div>
        </div>
    </div>

    

    <div class="container-fluid">
    <div class="row-fluid">
        <div class="span12 footer navbar-inverse navbar-fixed-bottom">
            <p class="copyright">&copy;2019 Derrick Lee's Blog. Powered by <a href="http://jekyllrb.com">Jekyll</a>, theme by <a href="https://github.com/scotte/jekyll-clean">Scott Emmons</a>
            under
            <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution</a></p>
        </div>
    </div>
</div>






</body>
</html>


</div>