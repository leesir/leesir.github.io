<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Derrick Lee's Blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="/js/jquery.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/theme.css" rel="stylesheet">
</head>

<body>

<div class="container-fluid">
    <div class="row-fluid">
        <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                  <span class="sr-only">Toggle navigation</span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">Derrick Lee's Blog</a>
              </div>
              <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li class="active"><a href="/">Home</a></li>
                    <li class="active visible-xs-block"><a href="/links.html">Links</a></li>
					<li class="active"><a href="/archive.html">Archive</a></li>
					<li class="active"><a href="/categories.html">Categories</a></li>
                    <li class="active"><a href="/tags.html">Tags</a></li>
                    <li class="active"><a href="/about.html">About</a></li>
                    
                      <li class="active"><a href="https://github.com/leesir/leesir.github.io">Github</a></li>
                    
                </ul>
              </div>
        </div>
    </div>
</div>


<div class="container container-left">
    <div class="row">
        <div class="col-md-3 hidden-xs">
            <div class="sidebar well">
译文分享
</div>

<div class="sidebar well">
    <h1>Recent Posts</h1>
    <ul>
        
          <li><a href="/2019/06/java-assert">Java语法糖-assert</a></li>
        
          <li><a href="/2019/06/system-logincache">一种基于redis的登录态的设计与实现</a></li>
        
          <li><a href="/2019/06/java-javasuger-innerclass">Java语法糖-内部类</a></li>
        
          <li><a href="/2019/06/java-javasuger">Java语法糖</a></li>
        
          <li><a href="/2016/08/java-history">Java的历史</a></li>
        
          <li><a href="/2016/07/java-history-beginning-words">Java历史开篇语</a></li>
        
          <li><a href="/2016/07/project-summary-2">项目总结-2016年07月11日</a></li>
        
          <li><a href="/2016/07/project-summary-1">Project Summary 1</a></li>
        
          <li><a href="/2016/07/summary-synchronized-error">对包装类型变量使用synchronized不当造成的同步不正确</a></li>
        
          <li><a href="/2016/07/boxed-type-conditional-op">包装类型在条件运算中的使用不当造成的空指针异常</a></li>
        
    </ul>
</div>

<div class="sidebar well">
<h1>Links</h1>
<ul>
  <li><a href="http://ifeve.com/" target="_blank">并发编程网</a></li>
  <li><a href="http://www.infoq.com/cn" target="_blank">InfoQ</a></li>
</ul>

</div>

        </div>
        <div class="col-md-9">
            
<div class="article">
    <div class="well">
        <h1><a href="/2019/06/java-assert">Jun 21, 2019 - Java语法糖-assert</a></h1>
        
        <div class="content">
		<link rel="stylesheet" href="/css/pygments.css" />

<p>       在谈断言之前，必须要谈谈2种编程方式：防御性编程与契约式编程。防御性编程来自于《代码大全》，契约式编程由伯特兰·迈耶与1986年提出。</p>

<p>       防御性编程强调不信任外部输入的参数，要对所有可能出现问题的数据加以判断，这种编程方式的代码中，通常存在大量重复的if语句。</p>

<p>       契约式编程强调系统内各组件必须按规定实现各自的逻辑，在组件交互的过程中不对参数进行校验，如果发现参数不符合要求，程序将立即终止执行。
现代编程语言通过断言的机制实现契约式编程，这种编程方式的代码比较简洁。</p>

<p>       然而在现今的软件开发过程中，不可能实现契约式编程：人员流动大、不愿意写文档、不愿意看文档、需求迭代快。
当然防御性编程也做的不好，否则就不会由bug了。甚至有时候某种做法属于防御性编程还是契约式编程都不清晰，比如使用注解式参数校验框架，看似属于契约式编程：代码简洁、快速失效。
而当反编译过后，实则大量基础if判断。</p>

<p>       防御性编程与契约式编程思想的出现，都算的上是软件开发思想的进步，而受制于当时的知识背景，难免在今天略显过时。就此结束讨论，进入正题。</p>

<p>       断言关键字自JDK 1.4引入，下面是Oracle官方文档的解释：</p>

<blockquote>
  <p>       An assertion is a statement in the JavaTM programming language that enables you to test your assumptions about your program. For example, if you write a method that calculates the speed of a particle, you might assert that the calculated speed is less than the speed of light.</p>

  <p>       Each assertion contains a boolean expression that you believe will be true when the assertion executes. If it is not true, the system will throw an error. By verifying that the boolean expression is indeed true, the assertion confirms your assumptions about the behavior of your program, increasing your confidence that the program is free of errors.</p>

  <p>       Experience has shown that writing assertions while programming is one of the quickest and most effective ways to detect and correct bugs. As an added benefit, assertions serve to document the inner workings of your program, enhancing maintainability.</p>
</blockquote>

<p>       除了在<a href="http://leesir.github.io/2019/06/java-javasuger">Java语法糖</a>这篇中介绍的断言的用法，还有一个差别不大但是可以自定义错误信息的用法，代码如下所示：</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"> 
<span class="k">assert</span> <span class="nc">Expression1</span> <span class="o">:</span> <span class="nc">Expression2</span> <span class="o">;</span></code></pre></figure>

<p>       其中，Expression1是一个布尔表达式。Expression2是一个值或者是一个有返回值的方法调用，将作为AssertionError的错误信息提示出来。</p>

<p>       实例代码如下：</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="n">assertcode</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.Random</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestAssertByteCode</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">assert1</span><span class="o">();</span>
        <span class="n">assert2</span><span class="o">();</span>
        <span class="n">assert3</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="cm">/**
     * 测试断言assert Expression1;
     */</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">assert1</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">assert1</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="n">assert1</span><span class="o">++;</span>
        <span class="k">assert</span> <span class="n">assert1</span> <span class="o">==</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**
     * 测试assert Expression1 : Expression2;
     * Expression2为普通值
     */</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">assert2</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">assert2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">().</span><span class="na">nextInt</span><span class="o">();</span>
        <span class="k">assert</span> <span class="n">assert2</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="o">:</span> <span class="s">"assert2"</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**
     * 测试assert Expression1 : Expression2;
     * Expression2为方法调用
     */</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">assert3</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">assert3</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">().</span><span class="na">nextInt</span><span class="o">();</span>
        <span class="k">assert</span> <span class="n">assert3</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="o">:</span> <span class="n">getAssert3ErrorMsg</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">getAssert3ErrorMsg</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="mi">3</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>       assert1、assert2、assert3断言检查失败，输出如下所示：</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">//assert1</span>
<span class="nc">Exception</span> <span class="n">in</span> <span class="n">thread</span> <span class="s">"main"</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">AssertionError</span>
	<span class="n">at</span> <span class="n">assertcode</span><span class="o">.</span><span class="na">TestAssertByteCode</span><span class="o">.</span><span class="na">assert1</span><span class="o">(</span><span class="nc">TestAssertByteCode</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">19</span><span class="o">)</span>
	<span class="n">at</span> <span class="n">assertcode</span><span class="o">.</span><span class="na">TestAssertByteCode</span><span class="o">.</span><span class="na">main</span><span class="o">(</span><span class="nc">TestAssertByteCode</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">8</span><span class="o">)</span>

<span class="c1">//assert2</span>
<span class="nc">Exception</span> <span class="n">in</span> <span class="n">thread</span> <span class="s">"main"</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">AssertionError</span><span class="o">:</span> <span class="n">assert2</span>
	<span class="n">at</span> <span class="n">assertcode</span><span class="o">.</span><span class="na">TestAssertByteCode</span><span class="o">.</span><span class="na">assert2</span><span class="o">(</span><span class="nc">TestAssertByteCode</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">21</span><span class="o">)</span>
	<span class="n">at</span> <span class="n">assertcode</span><span class="o">.</span><span class="na">TestAssertByteCode</span><span class="o">.</span><span class="na">main</span><span class="o">(</span><span class="nc">TestAssertByteCode</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">9</span><span class="o">)</span>

<span class="c1">//assert3</span>
<span class="nc">Exception</span> <span class="n">in</span> <span class="n">thread</span> <span class="s">"main"</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">AssertionError</span><span class="o">:</span> <span class="mi">3</span>
    <span class="n">at</span> <span class="n">assertcode</span><span class="o">.</span><span class="na">TestAssertByteCode</span><span class="o">.</span><span class="na">assert2</span><span class="o">(</span><span class="nc">TestAssertByteCode</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">21</span><span class="o">)</span>
    <span class="n">at</span> <span class="n">assertcode</span><span class="o">.</span><span class="na">TestAssertByteCode</span><span class="o">.</span><span class="na">main</span><span class="o">(</span><span class="nc">TestAssertByteCode</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">9</span><span class="o">)</span></code></pre></figure>

<p>       反编译后的代码也比较简单，以assert3为例反编译代码如下所示：</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">assert3</span><span class="o">()</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">assert3</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">().</span><span class="na">nextInt</span><span class="o">();</span>
    <span class="k">if</span> <span class="o">(!</span><span class="n">$assertionsDisabled</span> <span class="o">&amp;&amp;</span> <span class="n">assert3</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">AssertionError</span><span class="o">(</span><span class="nc">TestAssertByteCode</span><span class="o">.</span><span class="na">getAssert3ErrorMsg</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<h2 id="总结">总结</h2>

<h2 id="参考文献">参考文献</h2>

<p>[1] <a href="https://docs.oracle.com/javase/7/docs/technotes/guides/language/assert.html">Programming With Assertions</a>[EB/OL].https://docs.oracle.com/javase/7/docs/technotes/guides/language/assert.html，2019-06-21.<br /></p>

		<h1><a href="/2019/06/java-assert">阅读全文</a></h1>
        </div>
    </div>
</div>

<div class="article">
    <div class="well">
        <h1><a href="/2019/06/system-logincache">Jun 19, 2019 - 一种基于redis的登录态的设计与实现</a></h1>
        
        <div class="content">
		<link rel="stylesheet" href="/css/pygments.css" />

<h2 id="1前言">1.前言</h2>

<p><br /></p>

<p>       本文浅析一种可行的、实现简单的登录态方案。登录态几乎是所有系统都要考虑的问题，旨在维护用户登录之后的状态。
“用户登录”这个功能已经发展很多年了，伴随着“用户登录”的演进，登录态的实现也在不断完善。从最简单的在url后加一个参数作为标记，到现在大型站点的SSO，
登录态方案从单应用单机到多应用集群，不断满足不同架构的需求，也不断满足安全方面的需求。</p>

<p>       由于用户登录功能和登录态涉及的面非常广，比如密码的传输和存储、session共享、SSO、网络安全、第三方授权登录等，笔者见识尚浅，无法进行全面分析，
故本文仅就“登录态在服务器端的维护”一点进行阐述，上述方面不在本文讨论范围之内。笔者使用的redis版本为2.8.19，spring-data-redis版本为2.1.9。</p>

<p><br /></p>

<p class="center"><img src="/images/post_2019_06_19_image1.jpg" alt="login cache" height="60%" width="60%" /></p>

<p><br /></p>


		<h1><a href="/2019/06/system-logincache">阅读全文</a></h1>
        </div>
    </div>
</div>

<div class="article">
    <div class="well">
        <h1><a href="/2019/06/java-javasuger-innerclass">Jun 13, 2019 - Java语法糖-内部类</a></h1>
        
        <div class="content">
		<link rel="stylesheet" href="/css/pygments.css" />

<p>       Java中有5种内部类，公有静态内部类，私有静态内部类，公有内部类，私有内部类，匿名内部类。这里我们不谈各种内部类的使用场景，不对比优劣，仅从语法糖的角度学习Java是怎么实现内部类的。</p>

<h2 id="1静态内部类">1.静态内部类</h2>

<p>       静态内部类的初始化，不依赖于外部类的实例，并且不能访问外部类的实例变量，不能调用外部类的实例方法。</p>

<h4 id="公有静态内部类">公有静态内部类</h4>

<p>       测试代码如下所示：</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"> 
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestPubStaticInnerClass</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">priStaticValue</span> <span class="o">=</span> <span class="mi">3</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">pubStaticValue</span> <span class="o">=</span> <span class="mi">3</span><span class="o">;</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">priFOut</span><span class="o">()</span> <span class="o">{</span>

    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">pubFOut</span><span class="o">()</span> <span class="o">{</span>

    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">PubStaticInnerClass</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kt">int</span> <span class="nf">fPubStaticInnerClass</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">priFOut</span><span class="o">();</span>
            <span class="n">pubFOut</span><span class="o">();</span>
            <span class="k">return</span> <span class="n">priStaticValue</span> <span class="o">+</span> <span class="n">pubStaticValue</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">PubStaticInnerClass</span> <span class="n">pubStaticInnerClass</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PubStaticInnerClass</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>


		<h1><a href="/2019/06/java-javasuger-innerclass">阅读全文</a></h1>
        </div>
    </div>
</div>

<div class="article">
    <div class="well">
        <h1><a href="/2019/06/java-javasuger">Jun 6, 2019 - Java语法糖</a></h1>
        
        <div class="content">
		<link rel="stylesheet" href="/css/pygments.css" />

<p>       语法糖并不是Java独有的概念，而是一个计算机术语，先来看看百度百科的释义：</p>

<blockquote>
  <p>语法糖（Syntactic sugar），也译为糖衣语法，是由英国计算机科学家彼得·约翰·兰达（Peter J. Landin）发明的一个术语，指计算机语言中添加的某种语法，这种语法对语言的功能并没有影响，但是更方便程序员使用。通常来说使用语法糖能够增加程序的可读性，从而减少程序代码出错的机会。</p>
</blockquote>

<p class="center"><img src="/images/post_2019_06_06_image1.jpg" alt="Syntactic Suger" height="70%" width="70%" /></p>

<p><br />
       Java语言可以支持某些关键字或者语法的使用，但在编译后的字节码中，却看不到这些代码的痕迹。语法糖可以在性能无损的情况下，提高编程的效率，增加代码可读性，几乎所有的现代编程语言都含有语法糖成分。今天来简单回顾一下Java语言截止至今所包含的语法糖。
注：必须显示指定vm启动参数-ea或者-enableassertions，才可以让assert生效:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"> 
<span class="c1">//以下代码为命令行启动java的范例，各个IDE也有相应修改参数的地方，这里不再赘述</span>

<span class="n">java</span> <span class="o">-</span><span class="n">ea</span> <span class="nc">Main</span>
<span class="n">java</span> <span class="o">-</span><span class="n">enableassertions</span> <span class="nc">Main</span></code></pre></figure>


		<h1><a href="/2019/06/java-javasuger">阅读全文</a></h1>
        </div>
    </div>
</div>

<div class="article">
    <div class="well">
        <h1><a href="/2016/08/java-history">Aug 14, 2016 - Java的历史</a></h1>
        
        <div class="content">
		<link rel="stylesheet" href="/css/pygments.css" />

<p>       从第一代Java 1.0版本的发布至今，已有接近21年的时间了。21年里，计算机及互联网领域，出现了行业红利，出现了泡沫，出现了危机。伴随着行业起伏的大浪潮，同样出现了许许多多的市值千亿美金级别的软件、互联网公司。</p>

<p>       截止至目前，最新版本的Java 8的体系架构如下图所示：</p>

<p><img src="/images/post_2016_08_14_image1.png" alt="Java8_structure" /></p>

<p>       接下来，从1991年~2000年（Java的古代）、2002年~2006年（Java 的近代）、2006年至今（Java的现代）3个时间段，简单介绍一下Java语言诞生至今的重要时刻的时间线。</p>


		<h1><a href="/2016/08/java-history">阅读全文</a></h1>
        </div>
    </div>
</div>


<div class="pagination">
  
  <span class="page_number ">Page: 1 of 10</span>
  
    <a class="btn btn-default" href="/page2" class="next">Older</a>
  
</div>

        </div>
    </div>
</div>

<div class="container-fluid">
    <div class="row-fluid">
        <div class="span12 footer navbar-inverse navbar-fixed-bottom">
            <p class="copyright">&copy;2019 Derrick Lee's Blog. Powered by <a href="http://jekyllrb.com">Jekyll</a>, theme by <a href="https://github.com/scotte/jekyll-clean">Scott Emmons</a>
            under
            <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution</a></p>
        </div>
    </div>
</div>






</body>
</html>

